# day10

numpy

## kadai10-1

### 問題

連立方程式

<img src="https://latex.codecogs.com/gif.latex?x&space;&plus;&space;2&space;y&space;=&space;3" />


[tex:{x + 2 y = 3}]\\
[tex:{5 x + 7 y = 9}]\\

の解となる$x$と$y$を求めよ。連立方程式は、写像と同じであり、ベクトル$\mathbb{a}=(x,y)$が写像行列$\mathbb{M}=\begin{bmatrix}1&amp;2\\5&amp;7\end{bmatrix}$によってベクトル$\mathbb{b}=(3,9)$に移されたことをあらわす。

$ \mathbb{M}\mathbb{a} = \mathbb{b} $

よって、線形代数によると係数行列の逆行列が存在すれば、

$ \mathbb{a} = \mathbb{M}^{-1} \mathbb{b} $

により、解$\mathbb{a}=(x,y)$を求めることができる。

numpyには行列を引数に与えると逆行列を求める関数があるので（自分で調べよ）、

「行列$\mathbb{M}$と行列$\mathbb{b}$を引数に与えると、解$\mathbb{a}$を返す関数」を自作し、それを用いて上記の連立方程式を解くpythonコードを作成せよ。

### 回答

```powershell
$ python kadai10-1.py 
M = 
[[1 2]
 [5 7]]

a =
[-1.  2.]

b =
[3 9]
```

## kadai10-2

### 問題


    1 → 3
    2 → 5
    3 → 7
    4 → 9

のとき、10はどうなるか？

    10 →　？

まず、入力$x$と出力出力$y$を繋ぐモデル式（適当な係数と、入出力の使い方）を作る。

今、パターンが４つわかっているので、入力を４つの未知変数に拡張し、４つの未知係数を用いて

$ y = a x^3 + b x^2 + c x + d $

などとしてみる。係数$a,b,c,d$の3次式モデルである。未知変数への拡張のしかたは他にもいくらでも考えられる。

$ y = a x^{-3} + b x^{-2} + c x^{-1} + d $

のようなモデル式でもいいだろう。

ひとまず３次式モデルとすると、与えられた４つのパターンは

$ \begin{bmatrix} 1 &amp; 1 &amp; 1 &amp; 1\\ 8 &amp; 4 &amp; 2 &amp; 1\\ 27 &amp; 9 &amp; 3 &amp; 1\\ 64 &amp; 16 &amp; 4 &amp; 1 \end{bmatrix} \begin{bmatrix} a\\ b\\ c\\ d \end{bmatrix} = \begin{bmatrix} 3\\ 5\\ 7\\ 9 \end{bmatrix} $

と書くことができる。よって係数は

$ \begin{bmatrix} a\\ b\\ c\\ d \end{bmatrix} = \begin{bmatrix} 1 &amp; 1 &amp; 1 &amp; 1\\ 8 &amp; 4 &amp; 2 &amp; 1\\ 27 &amp; 9 &amp; 3 &amp; 1\\ 64 &amp; 16 &amp; 4 &amp; 1 \end{bmatrix}^{-1} \begin{bmatrix} 3\\ 5\\ 7\\ 9 \end{bmatrix} $ で求めることができ、その係数を使えば、

10 →　？

を推定できる。

実際この方法で、係数は、$(a,b,c,d) = (0,0,2,1)$と推定され、$y　=　2 x + 1$。すなわち、10　→　21　と推定される。

この推定値は、あくまで３次式モデルによる推定であり、他にも答えは考えられる。実際、先の逆数のモデルだと答えが異なる。

学習用のパターンを適当に４つ作り、適当にモデル式を作って係数を学習し、学習用パターンにない適当な入力を与えたときの出力を求めよ。（pythonコードで実現せよ）


### 回答

```powershell
$ python kadai10-2.py
M = 
[[ 1  1  1  1]
 [ 8  4  2  1]
 [27  9  3  1]
 [64 16  4  1]]
a = [ 0.00000000e+00 -3.55271368e-15  2.00000000e+00  1.00000000e+00]  
b = [3 5 7 9]
d = 29.999999999999716


M =
[[81 31 72 76]
 [18 46 31 78]
 [10 32 28 91]
 [81 54 18 32]]
a = [ 2.01212992 -3.14995061 -2.51646929  2.41910176]
b = [68  2 69 25]
d = 1696.161188367155

M =
[[90 94 69 22]
 [56 68 18 16]
 [43 59 16 99]
 [26 28 98 69]]
a = [-4.47804827  4.83095182  0.14800343 -0.14988017]
b = [58 78 80 23]
d = -3994.9718529977263

M =
[[75 98 92 16]
 [12 18 31 55]
 [74  3 43 99]
 [55  1  7 68]]
a = [-0.36963362 -1.07032138  1.72645677  0.54874961]
b = [35 60 98 28]
d = -453.9136966544332

M =
[[70 79 36 53]
 [48 30  3 81]
 [33 17 28 80]
 [67 91 70 92]]
a = [-1.19281333 -0.00468058  1.3580861   0.90519999]
b = [13 20 71 98]
d = -1170.6485312674238
```
